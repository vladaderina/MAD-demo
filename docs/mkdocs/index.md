# MAD — Metrics Anomaly Detection  
## Система обнаружения аномалий в метриках микросервисного приложения

[![docs](https://img.shields.io/badge/docs-MKDocs-blue)](#) [![license](https://img.shields.io/badge/license-MIT-green)](#) [![status](https://img.shields.io/badge/status-active-yellowgreen)](#)

**MAD** — это система мониторинга, которая автоматически находит аномалии в метриках вашего приложения с помощью машинного обучения. Вместо того чтобы вручную выставлять пороги для тысяч метрик, MAD постоянно обучается на ваших данных и сам сообщает о подозрительных отклонениях.

> **Ключевая идея:** Полный цикл — от сбора данных с метрик до ML-анализа, красивого дашборда и alert'а в Telegram. Этот проект отлично подходит для экспериментов с ML в мониторинге и может служить прототипом для DevOps/SRE команд.

---

## Что именно делает эта система?

Представьте, у вас есть куча метрик: загрузка CPU, потребление памяти, latency API-методов и т.д. Система MAD делает следующее:

1.  **Собирает** эти метрики из базы данных VictoriaMetrics (совместимой с Prometheus).
2.  **Обучает** нейросетевую модель (LSTM) для каждой важной метрики, чтобы понять её нормальное поведение.
3.  **Постоянно проверяет** новые данные: если текущие значения сильно отклоняются от прогноза модели — это аномалия.
4.  **Визуализирует** найденные аномалии в готовых Grafana-дашбордах.
5.  **Присылает** уведомление о проблеме прямо в Telegram.

**Коротко:** Автоматический поиск необычного в метриках без ручных настроек, с помощью ML.

---

## Для кого этот проект?

*   **DevOps/SRE-инженеры:** Чтобы построить более умную систему мониторинга поверх уже имеющегося стека (Prometheus/VictoriaMetrics, Grafana).
*   **ML-инженеры/Data Scientists:** Как готовый стенд для экспериментов с алгоритмами обнаружения аномалий во временных рядах.
*   **Разработчики:** Для понимания того, как можно интегрировать ML в операционные задачи.

> **Текущий статус:** Активный прототип (Proof-of-Concept). Система работает и выполняет свои функции, но может дорабатываться и улучшаться.

---

## Технологический стек

| Компонент | Для чего используется? |
| :--- | :--- |
| **Minikube / k3s** | Локальный Kubernetes-кластер для запуска всех компонентов системы. |
| **Helm / Terraform / Ansible** | Для автоматизации развёртывания инфраструктуры и приложений. |
| **VictoriaMetrics** | Высокопроизводительная база данных для хранения метрик (аналог Prometheus). |
| **Grafana** | Визуализация метрик и аномалий через удобные дашборды. |
| **PostgreSQL** | Хранит всё остальное: настройки, обученные ML-модели, историю аномалий. |
| **Python (FastAPI)** | Мозг системы: сервис анализа, который обучает модели и ищет аномалии. |
| **ML (LSTM, Optuna)** | LSTM-нейросети для детектирования аномалий, Optuna — для автоматического подбора их параметров. |
| **Telegram Bot** | Канал для отправки мгновенных уведомлений о найденных проблемах. |

---

## Ключевые возможности

*   **Умное обнаружение:** Поиск аномалий (всплесков, провалов, изменений тренда) с помощью ML-моделей, а не статических порогов.
*   **Поддержка PromQL:** Гибкая настройка метрик для анализа через знакомый язык запросов PromQL.
*   **Многомерный анализ:** Может одновременно анализировать несколько взаимосвязанных метрик для более точного детектирования.
*   **Централизованное хранение:** Все модели, события и настройки хранятся в PostgreSQL.
*   **Визуализация и оповещения:** Готовые дашборды в Grafana и интеграция с Telegram для alert'ов.
*   **Эксперименты с ML:** Архитектура позволяет легко тестировать и подключать новые алгоритмы (например, через библиотеку Optuna).